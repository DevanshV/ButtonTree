<!DOCTYPE HTML>
<html>

<head>
    <title>Issue Selector</title>
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Montserrat">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400' rel='stylesheet' type='text/css'>
    <link href='animations.css' rel='stylesheet' type='text/css'>
    <script src="data.js"></script>

    <script>
        $(document).ready(function() {
            $(".form").hide();
            $(".back").hide();
            var stage = 0;
            var primaryid = -1;
            var secondaryid = -1;
            var tertiaryid = -1;
            var finalid = -1;
            var issuetext;
            var indexnospace;

            //initializes
            initialize();

            function initialize() {
                //creates primary menu buttons
                for (i = 0; i < issues.length; i++) {
                    var index = issues[i].name;
                    var indexnospace = index.replace(/\s+/g, ''); //removes spaces to make class
                    var primarybutton = "<button type='button' class='primary btn btn-default " + indexnospace + "' id='" + i.toString() + "'>" + issues[i].img + "<p class='name'>" + index + "</p></button>";
                    $("span").append(primarybutton);
                    $(".primary").addClass("pt-page-scaleUp");
                }

                primaryid = -1;
                secondaryid = -1;
                tertiaryid = -1;
                finalid = -1;

                //waits for primary button click
                primaryclick();
            }

            function primaryclick() {
                $(".primary").click(function() {
                    $(".form").hide();
                    primaryid = this.id;

                    //creates secondary menu buttons
                    if (issues[primaryid].detail1) {
                        $("span").empty();
                        addSecondaryButtons(primaryid);
                    } else {
                        $(".form").fadeIn();
                    }

                });
            }

            function secondaryclick() {
                $(".secondary").click(function() {
                    $(".form").hide();
                    secondaryid = this.id;

                    //creates third stage buttons
                    if (issues[primaryid].detail1[secondaryid].detail2) {
                        $('span').empty();
                        addTertiaryButtons(primaryid, secondaryid);
                    } else {
                        $(".form").fadeIn();
                    }
                });
            }

            function Tertiaryclick() {
                $(".tertiary").click(function() {
                    $(".form").hide();
                    tertiaryid = this.id;

                    //creates fourth/final stage buttons
                    if (issues[primaryid].detail1[secondaryid].detail2[tertiaryid].detail3) {
                        $('span').empty();
                        addfinalbuttons(primaryid, secondaryid, tertiaryid);
                    } else {
                        $(".form").fadeIn();
                    }
                });

            }

            function finalclick() {
                $(".final").click(function() {
                    finalid = this.id;
                    $(".form").fadeIn();
                });

            }

            function addSecondaryButtons(primaryid) {
                for (j = 0; j < issues[primaryid].detail1.length; j++) {
                    var index = issues[primaryid].detail1[j].name;
                    var indexnospace = index.replace(/\s+/g, '');
                    var secondarybutton = "<button type='button' class='secondary pt-page-scaleUp btn btn-default " + indexnospace + "' id='" + j.toString() + "'>" + index + "</button>";
                    $("span").append(secondarybutton);
                    stage = 2;
                }

                //ensures ids are correct
                secondaryid = -1;
                tertiaryid = -1;
                finalid = -1;

                //display back button
                $(".back").show();
                $(".back").addClass("pt-page-scaleUp");

                //waits for secondary button click to show input
                secondaryclick();
            }

            function addTertiaryButtons(primaryid, secondaryid) {
                for (k = 0; k < issues[primaryid].detail1[secondaryid].detail2.length; k++) {
                    var index = issues[primaryid].detail1[secondaryid].detail2[k].name;
                    var indexnospace = index.replace(/\s+/g, '');
                    var tertiarybutton = "<button type='button' class='tertiary pt-page-scaleUp btn btn-default " + indexnospace + "' id='" + k.toString() + "'>" + index + "</button>";
                    $("span").append(tertiarybutton);
                    stage = 3;
                }

                //ensures ids are correct
                tertiaryid = -1;
                finalid = -1;

                //waits for tertiary button click to show input
                Tertiaryclick();
            }

            function addfinalbuttons(primaryid, secondaryid, tertiaryid) {
                for (m = 0; m < issues[primaryid].detail1[secondaryid].detail2[tertiaryid].detail3.length; m++) {
                    var index = issues[primaryid].detail1[secondaryid].detail2[tertiaryid].detail3[m];
                    var indexnospace = index.replace(/\s+/g, '');
                    var finalbutton = "<button type='button' class='final pt-page-scaleUp btn btn-default " + indexnospace + "' id='" + m.toString() + "'>" + index + "</button>";
                    $("span").append(finalbutton);
                    stage = 4;
                }
                //ensures ids are correct
                finalid = -1;

                //waits for final button click to show input
                finalclick();
            }

            $(".back").click(function() {
                if (stage == 1) {
                    $(".back").hide();
                } else if (stage == 2) {
                    $(".secondary").addClass("pt-page-scaleDownUp");
                    setTimeout(function() {
                        $("span").empty();
                    }, 300);
                    setTimeout(function() {
                        initialize();
                    }, 300);

                    $(".back").hide();
                    $(".form").hide();
                } else if (stage == 3) {
                    $(".tertiary").addClass("pt-page-scaleDownUp");
                    setTimeout(function() {
                        $("span").empty();
                    }, 300);
                    setTimeout(function() {
                        addSecondaryButtons(primaryid);
                    }, 300);

                    $(".form").hide();
                } else {
                    $(".final").addClass("pt-page-scaleDownUp");
                    setTimeout(function() {
                        $("span").empty();
                    }, 300);
                    setTimeout(function() {
                        addTertiaryButtons(primaryid, secondaryid);
                    }, 300);

                    $(".form").hide();
                }
            });

            $(".submit").click(function() {

                var one = "";
                var two = "";
                var three = "";
                var four = "";

                if (primaryid != -1)
                    one = issues[primaryid].name;

                if (secondaryid != -1)
                    two = " - " + issues[primaryid].detail1[secondaryid].name;

                if (tertiaryid != -1)
                    three = " - " + issues[primaryid].detail1[secondaryid].detail2[tertiaryid].name;

                if (finalid != -1)
                    four = " - " + issues[primaryid].detail1[secondaryid].detail2[tertiaryid].detail3[finalid];

                alert(one + two + three + four);

            });
        });

    </script>

    <style>
        .btn {
            margin: 10px !important;
            position: relative;
        }
        
        .primary {
            width: 160px !important;
            height: 170px;
        }
        
        .pickissue {
            font-family: 'Source Sans Pro' !important;
            margin: 0 0 10px 10px;
            font-size: 17px;
        }
        
        svg {
            width: 130px !important;
            height: 130px !important;
            padding-bottom: 10px;
        }
        
        body {
            margin-top: 30px;
        }
        
        .form-group {
            margin: 10px;
        }
        
        .name {
            bottom: 0px;
        }
        
        #credit {
            text-align: center;
        }

    </style>

</head>

<body class="container">
    <p class="pickissue"> Please pick an issue from the list below: </p>
    <span>

    </span>

    <div class="form">
        <div class='form-group'>
            <label for='inputlg'>Additional details:</label>
            <input class='form-control input-lg' id='inputlg' name="issue" type='text'>
        </div>
    </div>

    <div>
        <button type='button' class='back btn btn-primary back'>Back</button>
        <button type='button' class='submit form btn btn-success submit pull-right'>Submit</button>
    </div>
    <!--    <div id="credit">Icons made by <a href="http://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a>, <a href="http://www.flaticon.com/authors/scott-de-jonge" title="Scott de Jonge">Scott de Jonge</a>, <a href="http://www.flaticon.com/authors/puppets" title="Puppets">Puppets</a> from <a href="http://www.flaticon.com" title="Flaticon">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/" title="Creative Commons BY 3.0">CC BY 3.0</a></div>-->
</body>

</html>
